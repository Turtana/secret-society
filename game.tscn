[gd_scene format=3 uid="uid://dmrldqdwgvfk3"]

[ext_resource type="Script" uid="uid://c7yiypumm6tac" path="res://game.gd" id="1_e2o6t"]
[ext_resource type="Texture2D" uid="uid://d3hrjamj3chnr" path="res://Assets/prototausta1920x1080.03.png" id="2_ryrav"]
[ext_resource type="Texture2D" uid="uid://dkucf5wge8rl3" path="res://Assets/table01.png" id="3_7jktm"]
[ext_resource type="PackedScene" uid="uid://c511bacwkdgvt" path="res://button.tscn" id="3_feb5d"]
[ext_resource type="Texture2D" uid="uid://bavujxmdcupkb" path="res://Assets/skullbookframe01.png" id="4_j5wjh"]
[ext_resource type="AudioStream" uid="uid://byg6u7oj1jsic" path="res://Sounds/ShadowSocietyBGM.ogg" id="5_7jktm"]
[ext_resource type="AudioStream" uid="uid://cbc0gr0arwsok" path="res://Sounds/JonoEtenee.ogg" id="5_ryrav"]
[ext_resource type="Texture2D" uid="uid://1sqeu0ps1bsk" path="res://Assets/skullbookframe02.png" id="5_vef74"]
[ext_resource type="Texture2D" uid="uid://ltw0qkt6r6eq" path="res://Assets/greenbuttonup.png" id="7_iotsf"]
[ext_resource type="Texture2D" uid="uid://c7731w543snnw" path="res://Assets/greenbuttondown.png" id="8_lc2xo"]
[ext_resource type="Texture2D" uid="uid://dva57edjwr6an" path="res://Assets/redbuttonup.png" id="9_215e1"]
[ext_resource type="Texture2D" uid="uid://2laamhdny7ed" path="res://Assets/redbuttondown.png" id="10_7sc4i"]

[sub_resource type="SpriteFrames" id="SpriteFrames_hve3p"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("4_j5wjh")
}, {
"duration": 1.0,
"texture": ExtResource("5_vef74")
}],
"loop": true,
"name": &"default",
"speed": 10.0
}]

[sub_resource type="SpriteFrames" id="SpriteFrames_80cx4"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_iotsf")
}, {
"duration": 1.0,
"texture": ExtResource("8_lc2xo")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="SpriteFrames" id="SpriteFrames_e8heu"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("9_215e1")
}, {
"duration": 1.0,
"texture": ExtResource("10_7sc4i")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[node name="Game" type="Node2D" unique_id=1006541036]
script = ExtResource("1_e2o6t")

[node name="Background" type="Sprite2D" parent="." unique_id=1137387642]
position = Vector2(960, 540)
texture = ExtResource("2_ryrav")
metadata/_edit_lock_ = true

[node name="GuestLine" type="Node2D" parent="." unique_id=1432906182]
editor_description = "Just for z-ordering, all guests are child of this"

[node name="Table" type="Sprite2D" parent="." unique_id=1928580106]
self_modulate = Color(3.8529434, 3.8529434, 3.8529434, 1)
position = Vector2(576.5, 987)
scale = Vector2(2.2519531, 0.36328137)
texture = ExtResource("3_7jktm")

[node name="Book" type="AnimatedSprite2D" parent="." unique_id=437449973]
position = Vector2(475.00003, 811)
scale = Vector2(1.2, 1)
sprite_frames = SubResource("SpriteFrames_hve3p")
frame_progress = 0.8118334

[node name="Pass" parent="." unique_id=694192413 instance=ExtResource("3_feb5d")]
position = Vector2(320.00003, 872.99994)
scale = Vector2(2.8576238, 2.9440029)
visuals = SubResource("SpriteFrames_80cx4")

[node name="Reject" parent="." unique_id=1494534922 instance=ExtResource("3_feb5d")]
position = Vector2(604.00006, 872.99994)
scale = Vector2(2.8576238, 2.9440029)
visuals = SubResource("SpriteFrames_e8heu")

[node name="JudgePosition" type="Node2D" parent="." unique_id=1212954518]
position = Vector2(781, 1164)

[node name="Line" type="AudioStreamPlayer" parent="." unique_id=633194000]
stream = ExtResource("5_ryrav")
volume_db = -10.0

[node name="Music" type="AudioStreamPlayer" parent="." unique_id=1725131374]
stream = ExtResource("5_7jktm")
volume_db = -10.0
autoplay = true
parameters/looping = false

[node name="Rules" type="Panel" parent="." unique_id=459566737]
offset_right = 415.0
offset_bottom = 519.0

[node name="Text" type="RichTextLabel" parent="Rules" unique_id=902152027]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -181.5
offset_top = -233.5
offset_right = 181.5
offset_bottom = 233.5
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/normal_font_size = 32
bbcode_enabled = true
text = "[color=cyan]TODAY'S RULES[/color]

- just follow your gut
- drop em if you don't like their face"
horizontal_alignment = 1

[node name="Fails" type="Label" parent="Rules" unique_id=493865586]
layout_mode = 0
offset_left = 66.0
offset_top = 519.0
offset_right = 372.0
offset_bottom = 590.0
theme_override_font_sizes/font_size = 48
text = "Mistakes: 0/3"

[node name="Info" type="Label" parent="." unique_id=1027513879]
offset_left = 477.0
offset_right = 1502.0
offset_bottom = 189.0
theme_override_font_sizes/font_size = 64
text = "FYI"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Clock" type="Panel" parent="." unique_id=290087183]
offset_left = 781.0
offset_top = 829.0
offset_right = 1070.0
offset_bottom = 940.0

[node name="Time" type="Label" parent="Clock" unique_id=375855363]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -20.0
offset_top = -11.5
offset_right = 20.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_colors/font_color = Color(1, 0, 0, 1)
theme_override_font_sizes/font_size = 48
text = "45"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Timer" type="Timer" parent="Clock" unique_id=1706216465]
wait_time = 45.0
one_shot = true
autostart = true

[node name="Tutorial" type="Panel" parent="." unique_id=817633911]
visible = false
self_modulate = Color(0.03259791, 0.052465446, 0.2838502, 1)
offset_left = 199.0
offset_top = 189.0
offset_right = 1721.0
offset_bottom = 897.0

[node name="Text" type="RichTextLabel" parent="Tutorial" unique_id=263884444]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -671.0
offset_top = -297.0
offset_right = 681.0
offset_bottom = 224.0
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/normal_font_size = 32
bbcode_enabled = true
text = "[color=yellow]The Shadow Society[/color] has hired you as their bouncer.

Every [color=green]MEMBER[/color] wears a mask, which fulfill the [color=cyan]RULES[/color] for today's ritual. 
[color=red]SPIES[/color] will try to infiltrate the society, having bought bootleg carnival masks from nearby stalls. They seem to never find a passable mask, not even by luck.

Your job is to root out the spies and let all real members in. Check if the guest's mask abides by the rules, then either [color=green]PASS[/color] or [color=red]REJECT[/color] them by pressing the corresponding button.

Hurry up, the ritual is about to start..."
horizontal_alignment = 1
vertical_alignment = 1

[node name="Button" type="Button" parent="Tutorial" unique_id=1320836503]
layout_mode = 1
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -56.5
offset_top = -130.0
offset_right = 56.5
offset_bottom = -46.0
grow_horizontal = 2
grow_vertical = 0
theme_override_constants/outline_size = 4
theme_override_font_sizes/font_size = 48
text = "OK"

[node name="GameOver" type="Panel" parent="." unique_id=254517100]
visible = false
self_modulate = Color(0, 0, 0, 1)
offset_right = 1920.0
offset_bottom = 1080.0

[node name="Over" type="RichTextLabel" parent="GameOver" unique_id=56844490]
modulate = Color(1, 0, 0, 1)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -483.0
offset_top = -196.0
offset_right = 542.0
offset_bottom = 43.0
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/normal_font_size = 72
text = "GAME OVER"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Text" type="RichTextLabel" parent="GameOver" unique_id=209377436]
modulate = Color(1, 0, 0, 1)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -483.0
offset_top = -12.0
offset_right = 542.0
offset_bottom = 227.0
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/normal_font_size = 72
text = "You simply suck"
horizontal_alignment = 1
vertical_alignment = 1

[node name="DiffLabel" type="Label" parent="GameOver" unique_id=2029483357]
layout_mode = 1
offset_left = 552.0
offset_top = 767.0
offset_right = 726.0
offset_bottom = 822.0
theme_override_font_sizes/font_size = 40
text = "Difficulty: 3 rules"

[node name="Difficulty" type="HSlider" parent="GameOver" unique_id=92500007]
custom_minimum_size = Vector2(500, 100)
layout_mode = 0
offset_left = 552.0
offset_top = 829.0
offset_right = 1052.0
offset_bottom = 929.0
min_value = 2.0
max_value = 5.0
value = 3.0
tick_count = 4
ticks_on_borders = true
ticks_position = 2

[node name="Button" type="Button" parent="GameOver" unique_id=367854845]
layout_mode = 0
offset_left = 1108.0
offset_top = 829.0
offset_right = 1397.0
offset_bottom = 927.0
theme_override_font_sizes/font_size = 32
text = "Retry"

[node name="TutorialButton" type="Button" parent="." unique_id=612787975]
offset_left = 447.0
offset_top = 26.0
offset_right = 552.0
offset_bottom = 122.0
theme_override_font_sizes/font_size = 64
text = "  ?  "

[connection signal="timeout" from="Clock/Timer" to="." method="game_over" binds= ["The ritual has started"]]
[connection signal="pressed" from="Tutorial/Button" to="." method="close_tutorial"]
[connection signal="value_changed" from="GameOver/Difficulty" to="." method="difficulty_changed"]
[connection signal="pressed" from="GameOver/Button" to="." method="restart"]
[connection signal="pressed" from="TutorialButton" to="." method="show_tutorial"]
